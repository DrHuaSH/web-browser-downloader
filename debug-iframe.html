<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iframe åŠ è½½è¯Šæ–­å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #007acc;
        }
        .iframe-container {
            width: 100%;
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            margin: 10px 0;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .test-url {
            background: white;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 5px 0;
            cursor: pointer;
        }
        .test-url:hover {
            background: #e3f2fd;
        }
        .result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #005a9e; }
    </style>
</head>
<body>
    <h1>ğŸ” iframe åŠ è½½è¯Šæ–­å·¥å…·</h1>
    
    <div class="test-section">
        <h3>é—®é¢˜åˆ†æ</h3>
        <p>ç°ä»£æµè§ˆå™¨æœ‰ä¸¥æ ¼çš„å®‰å…¨ç­–ç•¥ï¼Œå¤§å¤šæ•°ç½‘ç«™éƒ½è®¾ç½®äº†ä»¥ä¸‹é™åˆ¶ï¼š</p>
        <ul>
            <li><strong>X-Frame-Options: DENY/SAMEORIGIN</strong> - ç¦æ­¢åœ¨iframeä¸­åŠ è½½</li>
            <li><strong>Content Security Policy (CSP)</strong> - é™åˆ¶iframeåµŒå…¥</li>
            <li><strong>HTTPSæ··åˆå†…å®¹</strong> - HTTPSé¡µé¢ä¸èƒ½åŠ è½½HTTPå†…å®¹</li>
            <li><strong>CORSç­–ç•¥</strong> - è·¨åŸŸèµ„æºå…±äº«é™åˆ¶</li>
        </ul>
    </div>

    <div class="test-section">
        <h3>æµ‹è¯•ä¸åŒç½‘ç«™çš„iframeå…¼å®¹æ€§</h3>
        <p>ç‚¹å‡»ä¸‹é¢çš„URLæµ‹è¯•æ˜¯å¦èƒ½åœ¨iframeä¸­åŠ è½½ï¼š</p>
        
        <div class="test-url" onclick="testIframe('https://httpbin.org/html')">
            https://httpbin.org/html (åº”è¯¥å¯ä»¥åŠ è½½)
        </div>
        
        <div class="test-url" onclick="testIframe('https://www.example.com')">
            https://www.example.com (åº”è¯¥å¯ä»¥åŠ è½½)
        </div>
        
        <div class="test-url" onclick="testIframe('https://jsonplaceholder.typicode.com')">
            https://jsonplaceholder.typicode.com (åº”è¯¥å¯ä»¥åŠ è½½)
        </div>
        
        <div class="test-url" onclick="testIframe('https://www.google.com')">
            https://www.google.com (å¯èƒ½è¢«é˜»æ­¢)
        </div>
        
        <div class="test-url" onclick="testIframe('https://www.github.com')">
            https://www.github.com (å¯èƒ½è¢«é˜»æ­¢)
        </div>
        
        <div class="test-url" onclick="testIframe('https://www.youtube.com')">
            https://www.youtube.com (å¯èƒ½è¢«é˜»æ­¢)
        </div>
        
        <div class="iframe-container">
            <iframe id="test-iframe" src="about:blank"></iframe>
        </div>
        
        <div id="test-results"></div>
    </div>

    <div class="test-section">
        <h3>è§£å†³æ–¹æ¡ˆå»ºè®®</h3>
        <div class="result warning">
            <strong>ç°å®æƒ…å†µï¼š</strong>å¤§å¤šæ•°ä¸»æµç½‘ç«™ï¼ˆGoogleã€Facebookã€YouTubeã€GitHubç­‰ï¼‰éƒ½ç¦æ­¢iframeåµŒå…¥ï¼Œè¿™æ˜¯æ­£å¸¸çš„å®‰å…¨æªæ–½ã€‚
        </div>
        
        <h4>å¯è¡Œçš„æ›¿ä»£æ–¹æ¡ˆï¼š</h4>
        <ol>
            <li><strong>æ–°çª—å£æ‰“å¼€</strong> - åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€ç½‘ç«™</li>
            <li><strong>ç½‘ç«™é¢„è§ˆ</strong> - æ˜¾ç¤ºç½‘ç«™æˆªå›¾å’ŒåŸºæœ¬ä¿¡æ¯</li>
            <li><strong>å†…å®¹æå–</strong> - æå–ç½‘ç«™çš„æ–‡æœ¬å†…å®¹æ˜¾ç¤º</li>
            <li><strong>ä¹¦ç­¾ç®¡ç†</strong> - ä¿å­˜å’Œç®¡ç†ç½‘ç«™é“¾æ¥</li>
        </ol>
    </div>

    <div class="test-section">
        <h3>æŠ€æœ¯æ£€æµ‹</h3>
        <button onclick="checkBrowserSupport()">æ£€æµ‹æµè§ˆå™¨æ”¯æŒ</button>
        <button onclick="checkSecurityPolicies()">æ£€æµ‹å®‰å…¨ç­–ç•¥</button>
        <button onclick="testCORS()">æµ‹è¯•CORS</button>
        
        <div id="tech-results"></div>
    </div>

    <script>
        function testIframe(url) {
            const iframe = document.getElementById('test-iframe');
            const results = document.getElementById('test-results');
            
            // æ¸…é™¤ä¹‹å‰çš„ç»“æœ
            results.innerHTML = '<div class="result warning">æ­£åœ¨æµ‹è¯•: ' + url + '</div>';
            
            // è®¾ç½®è¶…æ—¶æ£€æµ‹
            let loaded = false;
            const timeout = setTimeout(() => {
                if (!loaded) {
                    results.innerHTML += '<div class="result error">âŒ åŠ è½½è¶…æ—¶æˆ–è¢«é˜»æ­¢: ' + url + '</div>';
                }
            }, 5000);
            
            // ç›‘å¬åŠ è½½äº‹ä»¶
            iframe.onload = function() {
                loaded = true;
                clearTimeout(timeout);
                
                try {
                    // å°è¯•è®¿é—®iframeå†…å®¹
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    if (iframeDoc && iframeDoc.body) {
                        results.innerHTML += '<div class="result success">âœ… æˆåŠŸåŠ è½½: ' + url + '</div>';
                    } else {
                        results.innerHTML += '<div class="result warning">âš ï¸ åŠ è½½ä½†æ— æ³•è®¿é—®å†…å®¹: ' + url + '</div>';
                    }
                } catch (e) {
                    results.innerHTML += '<div class="result warning">âš ï¸ åŠ è½½ä½†è·¨åŸŸé™åˆ¶: ' + url + '</div>';
                }
            };
            
            iframe.onerror = function() {
                loaded = true;
                clearTimeout(timeout);
                results.innerHTML += '<div class="result error">âŒ åŠ è½½å¤±è´¥: ' + url + '</div>';
            };
            
            // å¼€å§‹åŠ è½½
            iframe.src = url;
        }
        
        function checkBrowserSupport() {
            const results = document.getElementById('tech-results');
            let report = '<h4>æµè§ˆå™¨æ”¯æŒæ£€æµ‹ï¼š</h4>';
            
            // æ£€æµ‹å„ç§APIæ”¯æŒ
            report += '<div class="result ' + (window.fetch ? 'success' : 'error') + '">Fetch API: ' + (window.fetch ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ') + '</div>';
            report += '<div class="result ' + (window.URL ? 'success' : 'error') + '">URL API: ' + (window.URL ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ') + '</div>';
            report += '<div class="result ' + (window.postMessage ? 'success' : 'error') + '">PostMessage: ' + (window.postMessage ? 'âœ… æ”¯æŒ' : 'âŒ ä¸æ”¯æŒ') + '</div>';
            
            // æ£€æµ‹å®‰å…¨ä¸Šä¸‹æ–‡
            report += '<div class="result ' + (window.isSecureContext ? 'success' : 'warning') + '">å®‰å…¨ä¸Šä¸‹æ–‡: ' + (window.isSecureContext ? 'âœ… HTTPS' : 'âš ï¸ HTTP') + '</div>';
            
            results.innerHTML = report;
        }
        
        function checkSecurityPolicies() {
            const results = document.getElementById('tech-results');
            let report = '<h4>å®‰å…¨ç­–ç•¥æ£€æµ‹ï¼š</h4>';
            
            // æ£€æµ‹CSP
            const metaTags = document.querySelectorAll('meta[http-equiv="Content-Security-Policy"]');
            report += '<div class="result ' + (metaTags.length > 0 ? 'warning' : 'success') + '">CSPç­–ç•¥: ' + (metaTags.length > 0 ? 'âš ï¸ å·²è®¾ç½®' : 'âœ… æœªè®¾ç½®') + '</div>';
            
            // æ£€æµ‹å½“å‰é¡µé¢åè®®
            report += '<div class="result ' + (location.protocol === 'https:' ? 'success' : 'warning') + '">é¡µé¢åè®®: ' + location.protocol + '</div>';
            
            results.innerHTML = report;
        }
        
        function testCORS() {
            const results = document.getElementById('tech-results');
            results.innerHTML = '<h4>CORSæµ‹è¯•ï¼š</h4><div class="result warning">æ­£åœ¨æµ‹è¯•...</div>';
            
            // æµ‹è¯•ä¸€ä¸ªå·²çŸ¥æ”¯æŒCORSçš„API
            fetch('https://httpbin.org/get')
                .then(response => response.json())
                .then(data => {
                    results.innerHTML += '<div class="result success">âœ… CORSè¯·æ±‚æˆåŠŸ</div>';
                })
                .catch(error => {
                    results.innerHTML += '<div class="result error">âŒ CORSè¯·æ±‚å¤±è´¥: ' + error.message + '</div>';
                });
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æµ‹
        window.onload = function() {
            checkBrowserSupport();
        };
    </script>
</body>
</html>