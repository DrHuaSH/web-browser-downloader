<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webæµè§ˆå™¨ä¸‹è½½å™¨ v3.0 - æ–°çª—å£æ¨¡å¼</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: #f8f9fa;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: white;
            padding: 16px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .url-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
        }
        
        .url-input:focus {
            border-color: #007acc;
        }
        
        .btn {
            background: #007acc;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .btn:hover {
            background: #005a9e;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        
        .status-bar {
            background: #e9ecef;
            padding: 8px 16px;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            text-align: center;
        }
        
        .welcome-card {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 600px;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .feature-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }
        
        .recent-sites {
            background: white;
            margin: 20px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .site-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            margin: 4px 0;
        }
        
        .site-item:hover {
            background: #f8f9fa;
        }
        
        .site-favicon {
            width: 16px;
            height: 16px;
            margin-right: 12px;
            border-radius: 2px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: #dc3545;
        }
        
        .notification.warning {
            background: #ffc107;
            color: #212529;
        }
    </style>
</head>
<body>
    <div class="header">
        <input 
            type="url" 
            class="url-input" 
            id="urlInput"
            placeholder="è¾“å…¥ç½‘å€ (ä¾‹å¦‚: google.com, github.com)"
            list="url-suggestions"
        >
        <datalist id="url-suggestions">
            <option value="https://www.google.com">
            <option value="https://www.github.com">
            <option value="https://www.example.com">
            <option value="https://httpbin.org">
            <option value="https://jsonplaceholder.typicode.com">
            <option value="https://www.baidu.com">
            <option value="https://www.youtube.com">
            <option value="https://www.bilibili.com">
        </datalist>
        <button class="btn" id="goBtn">è®¿é—®</button>
        <button class="btn btn-secondary" id="newTabBtn">æ–°æ ‡ç­¾é¡µ</button>
    </div>
    
    <div class="status-bar">
        <span id="statusText">å°±ç»ª</span>
        <span>v3.0.0 - æ–°çª—å£æ¨¡å¼</span>
    </div>
    
    <div class="main-content">
        <div class="welcome-card">
            <h1>ğŸŒ Webæµè§ˆå™¨ä¸‹è½½å™¨</h1>
            <p>ç”±äºç°ä»£æµè§ˆå™¨çš„å®‰å…¨é™åˆ¶ï¼Œå¤§å¤šæ•°ç½‘ç«™æ— æ³•åœ¨iframeä¸­æ˜¾ç¤ºã€‚<br>
            æœ¬ç‰ˆæœ¬æ”¹ä¸ºåœ¨æ–°çª—å£ä¸­æ‰“å¼€ç½‘ç«™ï¼Œæä¾›æ›´å¥½çš„æµè§ˆä½“éªŒã€‚</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”—</div>
                    <h3>æ™ºèƒ½è¡¥å…¨</h3>
                    <p>è‡ªåŠ¨è¡¥å…¨ç½‘å€åè®®å’ŒåŸŸå</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">âŒ¨ï¸</div>
                    <h3>å¿«æ·æ“ä½œ</h3>
                    <p>æ”¯æŒå›è½¦é”®å¿«é€Ÿè®¿é—®</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ†•</div>
                    <h3>æ–°çª—å£æ¨¡å¼</h3>
                    <p>åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€ç½‘ç«™</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“±</div>
                    <h3>ç§»åŠ¨å‹å¥½</h3>
                    <p>å®Œç¾é€‚é…æ‰‹æœºå’Œå¹³æ¿</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="recent-sites">
        <h3>ğŸ•’ æœ€è¿‘è®¿é—®</h3>
        <div id="recentSites">
            <div class="site-item" onclick="visitSite('https://www.example.com')">
                <img class="site-favicon" src="https://www.example.com/favicon.ico" onerror="this.style.display='none'">
                <span>Example.com - ç¤ºä¾‹ç½‘ç«™</span>
            </div>
            <div class="site-item" onclick="visitSite('https://httpbin.org')">
                <img class="site-favicon" src="https://httpbin.org/favicon.ico" onerror="this.style.display='none'">
                <span>HTTPBin - HTTPæµ‹è¯•å·¥å…·</span>
            </div>
            <div class="site-item" onclick="visitSite('https://jsonplaceholder.typicode.com')">
                <img class="site-favicon" src="https://jsonplaceholder.typicode.com/favicon.ico" onerror="this.style.display='none'">
                <span>JSONPlaceholder - APIæµ‹è¯•</span>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        class WebBrowser {
            constructor() {
                this.urlInput = document.getElementById('urlInput');
                this.goBtn = document.getElementById('goBtn');
                this.newTabBtn = document.getElementById('newTabBtn');
                this.statusText = document.getElementById('statusText');
                this.notification = document.getElementById('notification');
                this.recentSites = JSON.parse(localStorage.getItem('recentSites') || '[]');
                
                this.init();
            }
            
            init() {
                // äº‹ä»¶ç›‘å¬
                this.goBtn.addEventListener('click', () => this.handleGo());
                this.newTabBtn.addEventListener('click', () => this.handleNewTab());
                this.urlInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.handleGo();
                    }
                });
                
                // è¾“å…¥æ—¶çš„æ™ºèƒ½æç¤º
                this.urlInput.addEventListener('input', (e) => {
                    this.handleInputChange(e.target.value);
                });
                
                this.updateStatus('å°±ç»ª');
                this.loadRecentSites();
            }
            
            handleGo() {
                const url = this.urlInput.value.trim();
                if (!url) {
                    this.showNotification('è¯·è¾“å…¥ç½‘å€', 'error');
                    return;
                }
                
                const finalUrl = this.smartUrlCompletion(url);
                this.visitSite(finalUrl);
            }
            
            handleNewTab() {
                const url = this.urlInput.value.trim();
                if (!url) {
                    this.showNotification('è¯·è¾“å…¥ç½‘å€', 'error');
                    return;
                }
                
                const finalUrl = this.smartUrlCompletion(url);
                this.openInNewTab(finalUrl);
            }
            
            smartUrlCompletion(input) {
                let url = input.trim();
                
                // å¦‚æœå·²ç»æ˜¯å®Œæ•´çš„URLï¼Œç›´æ¥è¿”å›
                if (url.startsWith('http://') || url.startsWith('https://')) {
                    return url;
                }
                
                // å¦‚æœåŒ…å«åè®®ä½†ä¸æ˜¯http/httpsï¼Œä¿æŒåŸæ ·
                if (url.includes('://')) {
                    return url;
                }
                
                // å¦‚æœæ˜¯localhostæˆ–IPåœ°å€ï¼Œä½¿ç”¨http
                if (url.startsWith('localhost') || 
                    url.match(/^\d+\.\d+\.\d+\.\d+/) ||
                    url.startsWith('127.') ||
                    url.startsWith('192.168.') ||
                    url.startsWith('10.')) {
                    return 'http://' + url;
                }
                
                // å¦‚æœä¸åŒ…å«ç‚¹å·ï¼Œå¯èƒ½æ˜¯æœç´¢è¯ï¼Œæ·»åŠ wwwå’Œ.com
                if (!url.includes('.')) {
                    url = 'www.' + url + '.com';
                }
                
                // å¦‚æœæ²¡æœ‰wwwä½†æ˜¯å¸¸è§åŸŸåï¼Œæ·»åŠ www
                if (!url.startsWith('www.') && 
                    (url.includes('.com') || url.includes('.org') || url.includes('.net') || 
                     url.includes('.edu') || url.includes('.gov') || url.includes('.cn'))) {
                    const parts = url.split('.');
                    if (parts.length === 2) {
                        url = 'www.' + url;
                    }
                }
                
                // é»˜è®¤ä½¿ç”¨HTTPS
                return 'https://' + url;
            }
            
            visitSite(url) {
                try {
                    // éªŒè¯URL
                    new URL(url);
                    
                    this.updateStatus('æ­£åœ¨è®¿é—®: ' + url);
                    
                    // åœ¨å½“å‰çª—å£æ‰“å¼€
                    window.location.href = url;
                    
                    // æ·»åŠ åˆ°æœ€è¿‘è®¿é—®
                    this.addToRecent(url);
                    
                } catch (error) {
                    this.showNotification('æ— æ•ˆçš„ç½‘å€æ ¼å¼', 'error');
                    this.updateStatus('å°±ç»ª');
                }
            }
            
            openInNewTab(url) {
                try {
                    // éªŒè¯URL
                    new URL(url);
                    
                    this.updateStatus('åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€: ' + url);
                    
                    // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
                    const newWindow = window.open(url, '_blank');
                    
                    if (newWindow) {
                        this.showNotification('å·²åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€', 'success');
                        // æ·»åŠ åˆ°æœ€è¿‘è®¿é—®
                        this.addToRecent(url);
                    } else {
                        this.showNotification('å¼¹çª—è¢«é˜»æ­¢ï¼Œè¯·å…è®¸å¼¹çª—åé‡è¯•', 'warning');
                    }
                    
                    setTimeout(() => {
                        this.updateStatus('å°±ç»ª');
                    }, 2000);
                    
                } catch (error) {
                    this.showNotification('æ— æ•ˆçš„ç½‘å€æ ¼å¼', 'error');
                    this.updateStatus('å°±ç»ª');
                }
            }
            
            handleInputChange(value) {
                if (value.length > 0 && !value.includes('.') && !value.includes('://')) {
                    this.urlInput.title = `å°†è‡ªåŠ¨è¡¥å…¨ä¸º: https://www.${value}.com`;
                } else {
                    this.urlInput.title = '';
                }
            }
            
            addToRecent(url) {
                const site = {
                    url: url,
                    title: this.extractDomain(url),
                    timestamp: Date.now()
                };
                
                // ç§»é™¤é‡å¤é¡¹
                this.recentSites = this.recentSites.filter(s => s.url !== url);
                
                // æ·»åŠ åˆ°å¼€å¤´
                this.recentSites.unshift(site);
                
                // é™åˆ¶æ•°é‡
                if (this.recentSites.length > 10) {
                    this.recentSites = this.recentSites.slice(0, 10);
                }
                
                // ä¿å­˜åˆ°localStorage
                localStorage.setItem('recentSites', JSON.stringify(this.recentSites));
                
                this.loadRecentSites();
            }
            
            extractDomain(url) {
                try {
                    const urlObj = new URL(url);
                    return urlObj.hostname;
                } catch {
                    return url;
                }
            }
            
            loadRecentSites() {
                const container = document.getElementById('recentSites');
                
                if (this.recentSites.length === 0) {
                    container.innerHTML = '<p style="color: #6c757d; text-align: center;">æš‚æ— è®¿é—®è®°å½•</p>';
                    return;
                }
                
                container.innerHTML = this.recentSites.map(site => `
                    <div class="site-item" onclick="browser.visitSite('${site.url}')">
                        <img class="site-favicon" src="${site.url}/favicon.ico" onerror="this.style.display='none'">
                        <span>${site.title}</span>
                    </div>
                `).join('');
            }
            
            updateStatus(status) {
                this.statusText.textContent = status;
            }
            
            showNotification(message, type = 'success') {
                this.notification.textContent = message;
                this.notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    this.notification.classList.remove('show');
                }, 3000);
            }
        }
        
        // å…¨å±€å®ä¾‹
        const browser = new WebBrowser();
        
        // å…¨å±€å‡½æ•°ä¾›HTMLè°ƒç”¨
        function visitSite(url) {
            browser.visitSite(url);
        }
    </script>
</body>
</html>